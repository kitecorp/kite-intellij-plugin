plugins {
    id 'java'
    id 'org.jetbrains.intellij' version '1.17.4'
}

group = 'io.kite'
version = '0.1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

// Configure Gradle IntelliJ Plugin
// Read more: https://plugins.jetbrains.com/docs/intellij/tools-gradle-intellij-plugin.html
intellij {
    version = '2024.1'
    type = 'IC' // IntelliJ IDEA Community Edition
    plugins = []
}

// Configure Java
java {
    sourceCompatibility = JavaVersion.VERSION_21
    targetCompatibility = JavaVersion.VERSION_21
}

// Configure tasks
tasks.withType(JavaCompile).configureEach {
    options.encoding = 'UTF-8'
}

tasks.named('patchPluginXml') {
    sinceBuild = '241'
    untilBuild = '243.*'
}

tasks.named('signPlugin') {
    certificateChain = System.getenv("CERTIFICATE_CHAIN")
    privateKey = System.getenv("PRIVATE_KEY")
    password = System.getenv("PRIVATE_KEY_PASSWORD")
}

tasks.named('publishPlugin') {
    token = System.getenv("PUBLISH_TOKEN")
}