<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>io.kite.intellij-plugin</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>Kite</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor email="support@echostream.ro" url="https://github.com/kitecorp">EchoStream SRL</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Simple HTML elements (text formatting, paragraphs, and lists) can be added inside of <![CDATA[ ]]> tag.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
    Support for the Kite Infrastructure as Code (IaC) language.
    <br/>
    <br/>
    Kite is a modern IaC programming language designed as an alternative to Terraform,
    featuring multi-cloud provisioning, strong typing, and a clean syntax.
    <br/>
    <br/>
    Features:
    <ul>
      <li><b>Syntax Highlighting</b> - Full lexical and semantic highlighting for .kite files with type-aware coloring</li>
      <li><b>Go to Declaration</b> - Cmd+Click (Mac) or Ctrl+Click (Win/Linux) to navigate from identifier usages to their declarations. Supports:
        <ul>
          <li>Simple identifiers: click <code>server</code> to jump to <code>resource VM.Instance server { }</code></li>
          <li>Property access: click <code>size</code> in <code>server.size</code> to jump to the <code>size = ...</code> property inside the server declaration</li>
          <li>String interpolation: click <code>port</code> in <code>"${port}"</code> or <code>"$port"</code> to jump to the declaration (only the variable is underlined, not the entire string)</li>
        </ul>
      </li>
      <li><b>Find Usages</b> - Cmd+Click on a declaration name shows a dropdown of all usages with:
        <ul>
          <li>Context-aware icons (Resource, Component, Function, etc.)</li>
          <li>Full line of code preview</li>
          <li>File name and line number</li>
        </ul>
      </li>
      <li><b>Rename Refactoring</b> - Use Shift+F6 (or Refactor > Rename) to rename identifiers across the file:
        <ul>
          <li>Renames declarations and all their usages simultaneously</li>
          <li>Supports variables, inputs, outputs, resources, components, schemas, and functions</li>
          <li>Also renames references in string interpolation (<code>$var</code> and <code>${var}</code>)</li>
          <li>Validates new names against Kite identifier rules and keywords</li>
        </ul>
      </li>
      <li><b>Structure View</b> - Hierarchical outline with color-coded icons for resources, components, schemas, functions, types, variables, inputs, outputs, and imports</li>
      <li><b>Code Folding</b> - Collapse and expand declarations (components, resources, schemas, functions), control flow statements (for, while), object literals, and comments</li>
      <li><b>Code Formatting</b> - Automatic code formatting with 'Reformat Code' action (Cmd+Alt+L / Ctrl+Alt+L) including vertical alignment of object properties and declarations</li>
      <li><b>Comment/Uncomment</b> - Toggle line and block comments with keyboard shortcuts (Cmd+/ or Ctrl+/)</li>
      <li><b>Brace Matching</b> - Automatic highlighting of matching braces, brackets, and parentheses</li>
      <li><b>Breadcrumbs</b> - Navigation path showing current location (e.g., component > resource > property) at top/bottom of editor</li>
      <li><b>Custom Color Scheme</b> - Configurable syntax colors for keywords, types, literals, comments, and more via Settings > Editor > Color Scheme > Kite</li>
    </ul>
  ]]></description>

    <!-- Short summary of new features and bugfixes in the latest version -->
    <change-notes><![CDATA[
    <b>0.6.0</b>
    <ul>
      <li><b>Rename Refactoring</b> - Use Shift+F6 to rename identifiers across the file
        <ul>
          <li>Renames declarations and all their usages simultaneously</li>
          <li>Supports all declaration types: variables, inputs, outputs, resources, components, schemas, functions</li>
          <li>Also renames references in string interpolation (<code>$var</code> and <code>${var}</code>)</li>
          <li>Validates new names against Kite identifier rules and keywords</li>
        </ul>
      </li>
    </ul>
    <b>0.5.0</b>
    <ul>
      <li><b>Breadcrumbs Navigation</b> - Navigation path showing current location at top/bottom of editor
        <ul>
          <li>Shows hierarchical path: component > resource > property</li>
          <li>Object literals display their property names (e.g., <code>tag</code>, <code>New</code>)</li>
          <li>Supports all Kite declarations: components, resources, schemas, functions, types, variables</li>
        </ul>
      </li>
    </ul>
    <b>0.4.0</b>
    <ul>
      <li><b>Simple String Interpolation</b> - Navigate from <code>$variable</code> (without braces) to declarations
        <ul>
          <li>Both <code>${var}</code> and <code>$var</code> syntax now fully supported</li>
          <li>Cmd+Click on <code>$port</code> navigates to the port declaration</li>
        </ul>
      </li>
      <li><b>Code Completion</b> - Component references now show only output properties (not inputs)</li>
    </ul>
    <b>0.3.0</b>
    <ul>
      <li><b>String Interpolation Support</b> - Navigate from variables inside <code>${variable}</code> to their declarations
        <ul>
          <li>Only the variable name is underlined, not the entire string</li>
          <li><code>${</code> and <code>}</code> delimiters highlighted in orange</li>
        </ul>
      </li>
      <li><b>Formatter Fix</b> - Code formatter now preserves line breaks between declarations (var, input, output, etc.)</li>
    </ul>
    <b>0.2.0</b>
    <ul>
      <li><b>Go to Declaration</b> - Cmd+Click navigation to jump from identifier usages to their declarations</li>
      <li>Property access navigation: click <code>size</code> in <code>server.size</code> to navigate inside the declaration</li>
      <li><b>Find Usages</b> - Cmd+Click on a declaration name shows a dropdown of all usages with:
        <ul>
          <li>Context-aware colored icons (Resource, Component, Function, etc.)</li>
          <li>Full line of code preview</li>
          <li>File name and line number</li>
        </ul>
      </li>
      <li>Type-aware syntax highlighting: types shown in blue, other identifiers use default theme color</li>
    </ul>
    <b>0.1.0</b>
    <ul>
      <li>Fixed nested object literal indentation in code formatter</li>
      <li>Improved alignment for multi-line vs inline object literals</li>
      <li>Comments now properly break alignment groups</li>
      <li>Fixed schema property alignment with type annotations</li>
      <li>Better handling of VAR declaration alignment</li>
    </ul>
  ]]></change-notes>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- File type registration -->
        <fileType name="Kite"
                  implementationClass="io.kite.intellij.KiteFileType"
                  fieldName="INSTANCE"
                  language="Kite"
                  extensions="kite"/>

        <!-- Parser definition -->
        <lang.parserDefinition language="Kite"
                               implementationClass="io.kite.intellij.parser.KiteParserDefinition"/>

        <!-- Syntax highlighter -->
        <lang.syntaxHighlighterFactory language="Kite"
                                       implementationClass="io.kite.intellij.highlighting.KiteSyntaxHighlighterFactory"/>

        <!-- Color settings page -->
        <colorSettingsPage implementation="io.kite.intellij.highlighting.KiteColorSettingsPage"/>

        <!-- Annotator for semantic highlighting -->
        <annotator language="Kite"
                   implementationClass="io.kite.intellij.highlighting.KiteAnnotator"/>

        <!-- Annotator for duplicate declaration detection -->
        <annotator language="Kite"
                   implementationClass="io.kite.intellij.highlighting.KiteDuplicateDeclarationAnnotator"/>

        <!-- Structure view -->
        <lang.psiStructureViewFactory language="Kite"
                                       implementationClass="io.kite.intellij.structure.KiteStructureViewBuilderFactory"/>

        <!-- Commenter for comment/uncomment actions -->
        <lang.commenter language="Kite"
                        implementationClass="io.kite.intellij.KiteCommenter"/>

        <!-- Code folding support -->
        <lang.foldingBuilder language="Kite"
                             implementationClass="io.kite.intellij.KiteFoldingBuilder"/>

        <!-- Code formatter -->
        <lang.formatter language="Kite"
                        implementationClass="io.kite.intellij.formatter.KiteFormattingModelBuilder"/>

        <!-- Code style settings -->
        <langCodeStyleSettingsProvider implementation="io.kite.intellij.KiteLanguageCodeStyleSettingsProvider"/>

        <!-- Brace matching -->
        <lang.braceMatcher language="Kite"
                           implementationClass="io.kite.intellij.KiteBraceMatcher"/>

        <!-- Go to Declaration (Cmd+Click) -->
        <psi.referenceContributor language="Kite"
                                   implementation="io.kite.intellij.reference.KiteReferenceContributor"/>

        <!-- Go to Declaration handler -->
        <gotoDeclarationHandler implementation="io.kite.intellij.navigation.KiteGotoDeclarationHandler"/>

        <!-- Icon provider for navigation popups -->
        <iconProvider implementation="io.kite.intellij.navigation.KiteNavigationIconProvider"/>

        <!-- Highlight usages handler for identifier highlighting -->
        <highlightUsagesHandlerFactory implementation="io.kite.intellij.highlighting.KiteHighlightUsagesHandlerFactory"/>

        <!-- Code completion -->
        <completion.contributor language="Kite"
                                implementationClass="io.kite.intellij.completion.KiteCompletionContributor"/>

        <!-- Breadcrumbs navigation -->
        <breadcrumbsInfoProvider implementation="io.kite.intellij.KiteBreadcrumbsProvider"/>

        <!-- Rename refactoring support -->
        <lang.refactoringSupport language="Kite"
                                  implementationClass="io.kite.intellij.refactoring.KiteRefactoringSupportProvider"/>

        <!-- Names validator for identifiers -->
        <lang.namesValidator language="Kite"
                             implementationClass="io.kite.intellij.refactoring.KiteNamesValidator"/>

        <!-- Element manipulator for identifier renaming -->
        <lang.elementManipulator forClass="com.intellij.psi.impl.source.tree.LeafPsiElement"
                                  implementationClass="io.kite.intellij.refactoring.KiteIdentifierManipulator"/>

        <!-- Custom rename handler for Kite identifiers -->
        <renameHandler implementation="io.kite.intellij.refactoring.KiteRenameHandler"/>

    </extensions>
</idea-plugin>